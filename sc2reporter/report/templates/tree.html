
<html>
<script src="{{url_for('static', filename='js/jquery-1.9.1.min.js')}}"></script>
<script src="{{url_for('static', filename='js/d3.min.js')}}"></script>
<script src="{{url_for('static', filename='js/base_tree.js')}}"></script>
<script src="{{url_for('static', filename='js/d3_m_tree.js')}}"></script>
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"> -->
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='treeStyle.css') }}">


<div id="sidebar">
<form class="pure-form">
        <input type="text" id="searchNode">
        <button id="submitNode">Highlight node</button>
</form>

<button class="first-ele"  id="nodeLabels">Show Labels</button>
<button class="first-ele" id="colourNodes">Colour nodes</button>
<select name="metaOption" id="metaCats" method="GET">
        {% for ele in tree['metadata_list'] %}
        <option value= "{{ ele }}" SELECTED>{{ ele }}</option>
        {% endfor %}
</select>
</div>


<div id="tree-holder"></div>

<script>

var data = {{ tree|safe }}

// All the buttons 
const nodeLabels = document.getElementById('nodeLabels');  
const nodeColourButton = document.getElementById('colourNodes');  
const nodeColourDropdown = document.getElementById('metaCats');  
const searchNode = document.getElementById('searchNode');
const submitNode = document.getElementById('submitNode');

// Initiate the tree and attach it to the 'tree-holder' div
var tree = new D3MSTree("tree-holder",data);
var showLabels = false;
tree.centerGraph();




// Actions associated to the buttons
nodeLabels.addEventListener('click', ()=> {
        showLabels = !showLabels
        tree.showNodeLabels(showLabels);
        tree.showLinkLabels(showLabels);
})

nodeColourButton.addEventListener('click', ()=> {
        var metaCat = nodeColourDropdown.options[nodeColourDropdown.selectedIndex].value;
        tree.changeCategory(metaCat)
})

document.querySelector('form.pure-form').addEventListener('submit', function (e) {
        //prevent the normal submission of the form
        e.preventDefault();
        console.log(searchNode.value.split(" "))
        tree.highlightIDs(searchNode.value.split(" "), 'lightblue')
});

</script>

</html>